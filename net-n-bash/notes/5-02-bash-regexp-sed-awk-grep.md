### Regex и синтаксис
Regex - формальный язык поиска и осуществления манипуляций с подстроками в тексте. Может использоваться для поиска и для замены данных в тексте.
В терминале самые распространенные утилиты, поддерживающие выражения: grep, sed, awk.

Метасимволы:
 - `.`   - любой символ;
 - `[]`  - диапазон символов или возможные символы;
 - `[^]` - все символы, кроме указанных в фигурных скобка;
 - `*`   - ноль и больше символов перед знаком;
 - `+`   - один и больше символов перед знаком;
 - `?`   - ноль или одно выражение перед знаком.

Квантификаторы:
 - `{n}`   - непосредственное количество;
 - `{n,}`  - n или больше;
 - `{n,m}` - не меньше чем n и не больше чем m;
 - `{,m}`  - не больше чем m.

Экранирование осуществляется с помощью символа `\`. Применить квантификатор или некоторые метасимволы сразу к нескольким символам можно использовав группировку `()`. В качестве логического ИЛИ можно использовать `|`.
Примеры: `(www.)?netology\.[a-z]{2,4}`, `(Moscow|Paris|London)+`.

### Grep
Grep - утилита, для поиска строк соответствующих регулярному выражению.
`grep -E 'regexp' stdin`

Важные ключи:
 - `-v` - инвертирует вывод; 
 - `-c` - подсчет количества выводимых строк вместо их вывода;
 - `-n` - вывод номера строки;
 - `-i` - нечувствительность к регистру;
 - `-r` - рекурисвный поиск по всем файлам.

### Sed

Sed - потоковый текстовый редактор. Получает входящий поток (в виде файла) и редактируер его.
```bash
sed -e 's/abc/xyz/g' file > file2` # - заменяет все вхождения abc на xyz в файле file и перенаправляет получившийся результат file2.
echo '123asd123' | sed 's/1/3/g
ps aux | sed 's/.*root.*//g'
```
Ключ `-i, --in-place` - производит замену в изначальном файле. Перед использованием рекомендуется забекапить файл.

### Awk

Данные поступающие в awk можно представить в виде таблицы, где строки это строки, а делителем столбцов выступает пробел.

Все столбцы заносятся в переменные:
 - $0 - вся строка целиком;
 - $1 - первый столбец;
 - $2 - второй столбец;
 . . .

Разделитель можно заменить используя ключ `-F`: `-F:` - разделитель заменен на `:`.

```bash
ps aux | awk '{print $2 " " $8}'
ps aux | awl '{if ($2 > 200) print $2}'
cat /proc/loadavg | awk '{i=1; sum=0; while (i<4){ sum += $i; i++ } print sum }'

# Просмотр сводой статистики по кодам ответа Nginx
cat /var/log/nginx/access.log | awk '{print $9}' | sort -n | uniq -c

# Запишем некоторый фрагмент сетевых логов и посмотрим статистику по отправленным и принятым пакетам
tcpdump -n > tcpdump.txt
cat tcpdump.txt | awk '{a=gensub("\.[a-z0-9]+$","","g",$3); b=gensub("\.[a-z0-9:]+$","","g",$5); print a " " $4 " " b}' | sort -n | uniq -c
```
